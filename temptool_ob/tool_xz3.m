%Combine effect of fric+rub in tool
a=0:0.1:1.1; b=-3:0.1:3;
m=1;t=[];
for i=1:length(a)
    s=a(i);
    for j=1:length(b)
      v=b(j);
      t(i,j)=integ1(s,v);
    end
end
disp(t);
[c,h]=contour(b,a,t,10,'ShowText','on')
h.LevelList=round(h.LevelList,0)  %rounds levels to 3rd decimal place
clabel(c,h)
colorbar
set(gca,'YDir','reverse')  

function theta=integ1(a,b)
    fun1 = @(x) 754*x.*(abs(-1.*log(-1.*b - 2.5 + 0.1.*x + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 + 5.0.*b - 0.2*b.*x + 1.01*x.^2 - 0.50*x))) + abs(log(2.5 + 0.1*x - 1.*b + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 - 5.0*b - 0.2*b.*x + 1.01*x.^2 + 0.50*x)))+abs(-log(-2.5-b+0.1*x+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01*x.^2-4.4*a+5*b-4.9*x+11.09)))+abs(log(2.5+0.1*x-b+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01.*x.^2-4.4*a-5*b-3.9*x+11.09))));
    q1 = integral(fun1,0, 0.98);
    fun11 = @(x,y) 739*(abs(-1.*log(-1.*b - 2.5 + 0.1.*x + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 + 5.0.*b - 0.2*b.*x + 1.01*x.^2 - 0.50*x))) + abs(log(2.5 + 0.1*x - 1.*b + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 - 5.0*b - 0.2*b.*x + 1.01*x.^2 + 0.50*x)))+abs(-log(-2.5-b+0.1*x+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01*x.^2-4.4*a+5*b-4.9*x+11.09)))+abs(log(2.5+0.1*x-b+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01.*x.^2-4.4*a-5*b-3.9*x+11.09))));
    q11 = integral(fun11,0.98, 1.1);
    fun2 = @(x,y) 754*x.*(abs(-1.*log(-1.*b - 2.5 + 0.1.*x + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 + 5.0.*b - 0.2*b.*x + 1.01*x.^2 - 0.50*x))) + abs(log(2.5 + 0.1*x - 1.*b + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 - 5.0*b - 0.2*b.*x + 1.01*x.^2 + 0.50*x)))+abs(-log(-2.5-b+0.1*x+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01*x.^2-4.4*a+5*b-4.9*x+11.09)))+abs(log(2.5+0.1*x-b+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01.*x.^2-4.4*a-5*b-3.9*x+11.09)))).*(x/1.1).^0.26;
    q2 = integral(fun2,0, 0.98);
    fun22 = @(x,y) 738*(abs(-1.*log(-1.*b - 2.5 + 0.1.*x + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 + 5.0.*b - 0.2*b.*x + 1.01*x.^2 - 0.50*x))) + abs(log(2.5 + 0.1*x - 1.*b + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 - 5.0*b - 0.2*b.*x + 1.01*x.^2 + 0.50*x)))+abs(-log(-2.5-b+0.1*x+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01*x.^2-4.4*a+5*b-4.9*x+11.09)))+abs(log(2.5+0.1*x-b+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01.*x.^2-4.4*a-5*b-3.9*x+11.09)))).*(x/1.1).^0.26;
    q22 = integral(fun22,0.98, 1.1);
    fun3 = @(x,y) 753*x.*(abs(-1.*log(-1.*b - 2.5 + 0.1.*x + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 + 5.0.*b - 0.2*b.*x + 1.01*x.^2 - 0.50*x))) + abs(log(2.5 + 0.1*x - 1.*b + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 - 5.0*b - 0.2*b.*x + 1.01*x.^2 + 0.50*x)))+abs(-log(-2.5-b+0.1*x+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01*x.^2-4.4*a+5*b-4.9*x+11.09)))+abs(log(2.5+0.1*x-b+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01.*x.^2-4.4*a-5*b-3.9*x+11.09)))).*(x/1.1).^15;
    q3 = integral(fun3,0, 0.98);
    fun33 = @(x,y) 738*(abs(-1.*log(-1.*b - 2.5 + 0.1.*x + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 + 5.0.*b - 0.2*b.*x + 1.01*x.^2 - 0.50*x))) + abs(log(2.5 + 0.1*x - 1.*b + sqrt(a.^2 - 2.*a.*x + b.^2 + 6.25 - 5.0*b - 0.2*b.*x + 1.01*x.^2 + 0.50*x)))+abs(-log(-2.5-b+0.1*x+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01*x.^2-4.4*a+5*b-4.9*x+11.09)))+abs(log(2.5+0.1*x-b+sqrt(a.^2+2*a.*x+b.^2-0.2*b.*x+1.01.*x.^2-4.4*a-5*b-3.9*x+11.09)))).*(x/1.1).^15;
    q33 = integral(fun33,0.98, 1.1);
    
    fun4 = @(y,l) 0.18.*(1./((a-0.1*l-1.1).^2+(b-y).^2+(+l).^2).^0.5+1./((a-0.1*l-1.1).^2+(b-y).^2+(-l).^2).^0.5);
    q4 = integral2(fun4,-2.5,2.5,0,0.08);

    theta=0.238*(0.87*(q1+q11)-0.58*(q2+q22)-1.5*(q3+q33)+2287*q4);
end